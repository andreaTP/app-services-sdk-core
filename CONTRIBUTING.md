# Contributing

## Requirements
- [NodeJS 14.x lts](https://nodejs.org/en/about/releases/) or above
- [YQ 4.6.x](https://github.com/mikefarah/yq#install) or above

## Updating OpenAPI spec

All specifications are kept in `.openapi` folder:

https://github.com/redhat-developer/app-services-sdk-core/tree/main/.openapi

## Autogeneration of SDKs

1. All SDKs are autogenerated using OpenAPI Generator project.
2. Bot accounts creates PR with the new versions of the SDK that needs be reviewed by the team, these bot accounts are triggered by changes to openapi spec changes in other repoistories. These events are then  
3. Once PR is merged developers are responsible for creating tagged release

## Generating API clients locally

```bash
make generate
```

## Updating error codes

Error codes are fetched dynamically from backend and generated inside every SDK.
To generate error codes execute:

```bash
bash scripts/errors/fetch-errors.sh
node scripts/errors/generate_errors.js
```

## Releases
### Java
- Go to the actions tab in Github
- Go to the `Java Release` workflow 
- Press `Run workflow` and enter the new version that will be released pointing to the correct branch
- The workflow will run creating a Github release with the version name and a branch `release-{version}`

### GO
- Go to the releases tab in Github and draft a new release
- The tag should follow the format `app-services-sdk-go/v{Major-Minor-Path}`
- The title of the release should follow the format `app-services-sdk-go app-services-sdk-go/v{Major-Minor-Path}`
- Auto generate the patch notes making any changes you find sutible
- Press `Publish release`

## Checking standards

## Onboarding a new API
The OpenAPI Spec file should be validated before being added to the SDK genartion list.
This can be done as follows:

```bash
npm i @rhoas/spectral-ruleset
make lint TARGET=.openapi/kafka-admin-rest.yaml
```

The [generate](./scripts) script for each langauge should then be updated with the new API details.

## Documentation portal

Documentation portal is available https://console.redhat.com/docs/api

> NOTE: Documentation portal uses `doc-portal` branch as source for the API
When releasing service to production we need to trigger documentation portal release

### Releasing documentation portal changes

Create release with `docs/` prefix. For example `docs/v0.1.0`.
Review openapi updates.

### Certificate of Origin

By contributing to this project you agree to the Developer Certificate of
Origin (DCO). This document was created by the Linux Kernel community and is a
simple statement that you, as a contributor, have the legal right to make the
contribution. See the [DCO](DCO) file for details.
